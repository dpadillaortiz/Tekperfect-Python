#! /usr/bin/python3

from pymetasploit3.msfrpc import *

EXPLOIT_FILE = 'Console-Output/all-exploits.txt'

PAYLOAD_FILE = 'Console-Output/all-payloads.txt'

class MSFuncs:
    
    def __init__(self, password):
        self.password = password

    def exploitsToFile(self):
        client = MsfRpcClient(self.password, port=55552, ssl=False)
        exploits = client.modules.exploits
        with open(EXPLOIT_FILE, 'w') as data:
            for exploit in exploits:
                data.write(exploit)
                data.write('\n')

    def payloadsToFile(self):
        client = MsfRpcClient(self.password, port=55552, ssl=False)
        payloads = client.modules.payloads
        with open(PAYLOAD_FILE, 'w') as data:
            for payload in payloads:
                data.write(payload)
                data.write('\n')

def searchFor(search, file):
    query = []
    with open(file, 'r') as data:
        for item in data:
            if search in item:
                query.append(item.strip('\n'))
    return query

MSFuncs('QjmVHzDD').payloadsToFile()


smbExploits = searchFor('ssh', EXPLOIT_FILE)
print(smbExploits)
